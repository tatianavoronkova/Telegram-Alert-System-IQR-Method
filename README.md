# Создание системы алертов для сервиса ленты новостей. Автоматизация уведомлений через Apache Airflow и Telegram
## Входные данные:
В приложении есть сервис ленты новостей. Требуется своевременно реагировать на технический сбой в работе сервиса, сбои в ETL-процессах, ошибки при обработке данных, внешние факторы и т.д.
В случае возникновения вышеперечисленных ошибок возникают аномалии в данных. Принято решение создать систему алертов, которая каждые 15 минут будет проверять ключевые метрики, такие как:  
- Активные пользователи,
- Количество просмотров,
- Количество лайков,
- CTR (Click-Through Rate)

## Задача: создать DAG в Apache Airflow для автоматического расчета метрик и отправки уведомлений в Telegram
1. Анализ данных:
  - Изучить поведение каждой метрики, выявить закономерности и аномалии
  - Применить метод межквартильного размаха для детектирования аномалий
2. Детектирование аномалий:
  - Сравнить значение метрики за текущие 15 минут с таким же периодом, но день назад
  - Выявить значительные отклонения и классифицировать их как аномалии
3. Алертинг:
- При обнаружении аномалий отправлять уведомление в чат. Сообщение должно включать:
    - Название метрики
    - Текущее значение метрики
    - Величину отклонения
    - Графики, чтобы упростить исследование причины аномалии
4. Автоматизация системы алертов с помощью Airflow:
- Настроить DAG для автоматического запуска мониторинга каждые 15 минут
- Интегрировать workflow для детектирования и уведомления в чат через Airflow

## Технологии и подходы:
- Airflow для планирования и автоматизации задач
- Реализация скрипта для сбора и мониторинга метрик каждые 15 минут
- Применение статистических методов для анализа данных (IQR)
- Использование Telegram для отправки алертов в чат

## Результат:

**Пример сообщения (алерта) в Telegram:**

"Метрика **users_qty:** текущее значение = **612.00**, отклонение от предыдущего значения **3.20%**"  
"Метрика **views:** текущее значение = **6580.00**, отклонение от предыдущего значения **-0.66%**"  
"Метрика **likes:** текущее значение = **1372.00**, отклонение от предыдущего значения **-0.65%**"  
"Метрика **CTR**: текущее значение = **0.21**, отклонение от предыдущего значения **0.01%**"  

<image width="400" height="300" src="/images/Alert_system_users.JPG" alt="Number of new users"> <image width="400" height="300" src="/images/Alert_system_views.JPG" alt="Number of new views">
<image width="400" height="300" src="/images/Alert_system_likes.JPG" alt="Number of new likes"> <image width="400" height="300" src="/images/Alert_system_ctr.JPG" alt="CTR">  


Автоматизация системы через Airflow обеспечит регулярный мониторинг метрик и оперативное реагирование на возможные аномалии.
